@model List<UserModel>
@{
    ViewData["Title"] = "Admin Panel";
}
<div class="container-fluid">
    <div class="row">
        <!-- Side Bar -->
        <nav id="sidebar" class="col-md-3 col-lg-2 d-md-block bg-light sidebar">
            <div class="position-sticky">
                <ul class="nav flex-column">
                    <li class="nav-item">
                        <a class="nav-link" href="#pending-users">
                            Pending Users
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#all-users">
                            Users
                        </a>
                    </li>
                </ul>
            </div>
        </nav>

        <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
            <!-- Tabela de Users Pendentes -->
            <div id="pending-users" class="table-container">
                <h1>Pending Users</h1>
                <!-- Coloque aqui o código da sua tabela de usuários pendentes -->
                <table class="table table-striped table-hover">
                    <thead>
                        <tr>
                            <th scope="col">#</th>
                            <th scope="col">Name</th>
                            <th scope="col">UserName</th>
                            <th scope="col">Email</th>
                            <th scope="col">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (UserModel user in Model.Where(u => u.Role == "EndUser"))
                        {
                            <tr>
                                <td>@user.UserId</td>
                                <td>@user.Name</td>
                                <td>@user.Username</td>
                                <td>@user.Email</td>
                                <td>
                                    <form asp-controller="AdminPanel" asp-action="SetAsPrivileged" method="post">
                                        <input type="hidden" name="id" value="@user.UserId" />
                                        <button type="submit" class="btn btn-success">Accept</button>
                                    </form>
                                    <a role="button" class="btn btn-danger">Reject</a>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>

            <!-- Tabela  Users -->
            <div id="all-users" class="table-container" style="display: none;">
                <h1>Users</h1>
                <table class="table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Name</th>
                            <th>Username</th>
                            <th>Email</th>
                            <th>Role</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (UserModel user in Model.Where(u => u.Role == "Privileged" || u.Role == "Administrator"))
                        {
                            <tr>
                                <td>@user.UserId</td>
                                <td>@user.Name</td>
                                <td>@user.Username</td>
                                <td>@user.Email</td>
                                <td>@user.Role</td>
                                <td>
                                    <a role="button" class="btn btn-warning btn-sm" asp-route-id="@user.UserId" asp-controller="AdminPanel" asp-action="Edit">Edit</a>
                                    <form asp-controller="AdminPanel" asp-action="SetAsEndUser" method="post" style="display: inline-block;">
                                        <input type="hidden" name="id" value="@user.UserId" />
                                        <button type="submit" class="btn btn-danger" }>Set as EndUser</button>
                                    </form>
                                    <form asp-controller="AdminPanel" asp-action="SetAsPrivileged" method="post" style="display: inline-block;">
                                        <input type="hidden" name="id" value="@user.UserId" />
                                        <button type="submit" class="btn btn-success" @if (user.Role == "Privileged")
                                        {
                                            <text>disabled</text>
                                        }>Set as Privileged</button>
                                    </form>
                                    <form asp-controller="AdminPanel" asp-action="SetAsAdministrator" method="post" style="display: inline-block;">
                                        <input type="hidden" name="id" value="@user.UserId" />
                                        <button type="submit" class="btn btn-primary" @if (user.Role == "Administrator")
                                        {
                                            <text>disabled</text>
                                        }>Set as Administrator</button>
                                    </form>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </main>
    </div>
</div>

<button role="button" class="btn btn-secondary btn-sm">Export Data</button>

<script>
    // Evento de clique aos links na barra lateral
    document.querySelectorAll(".nav-link").forEach(function (link) {
        link.addEventListener("click", function () {
            var target = link.getAttribute("href").substring(1); // Remove o "#" do href
            showTable(target);
        });
    });

    // Função para mostrar uma tabela e ocultar as outras
    function showTable(tableId) {
        var tables = document.querySelectorAll(".table-container");
        tables.forEach(function (table) {
            if (table.id === tableId) {
                table.style.display = "block";
            } else {
                table.style.display = "none";
            }
        });
    }
</script>
