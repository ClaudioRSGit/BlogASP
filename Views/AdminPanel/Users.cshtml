@model AdminPanelViewModel


<div id="all-users" class="table-container">
    <h1>Users</h1>
    <br />
    <table class="table">
        <thead>
            <tr>
                <th style="text-align: center;">#</th>
                <th style="text-align: center;">Username</th>
                <th style="text-align: center;">Email</th>
                <th style="text-align: center;">Role</th>
                <th style="text-align: center;">CreatedAt</th>
                <th style="text-align: center;">UpdatedAt</th>
                <th style="text-align: center;">DeletedAt</th>
                <th style="text-align: center;">Actions</th>
            </tr>
        </thead>
        <tbody>
            @foreach (UserModel user in Model.Users.Where(u => u.Role == "Privileged" || u.Role == "Administrator" || u.Role == "Disabled"))
            {
                <tr>
                    <td style="text-align: center;">@user.UserId</td>
                    <td style="text-align: center;">@user.Username</td>
                    <td style="text-align: center;">@user.Email</td>
                    <td style="text-align: center;">@user.Role</td>
                    <td style="text-align: center;">@user.CreatedAt</td>
                    <td style="text-align: center;">@user.UpdatedAt</td>
                    <td style="text-align: center;">
                        @{
                            if (user.DeletedAt == null)
                            {
                                @: 01/01/0001 00:00:00
                            }
                            else
                            {
                                @user.DeletedAt
                            }
                        }
                    </td>
                    <td style="text-align: center;">
                        @if (user.Role == "Disabled")
                        {
                            <form asp-controller="AdminPanel" asp-action="EnableUser" method="post">
                                <input type="hidden" name="id" value="@user.UserId" />
                                <button type="submit" class="btn btn-primary">Enable</button>
                            </form>
                        }
                        else
                        {
                            <div class="btn-group" role="group" style="display: flex;">
                                <form asp-controller="AdminPanel" asp-action="DisableUser" method="post">
                                    <input type="hidden" name="id" value="@user.UserId" />
                                    <button type="submit" class="btn btn-danger rounded-pill" style="margin-right: 5px;">Disable</button>
                                </form>
                                <a role="button" class="btn btn-warning btn-sm rounded-pill" style="margin-right: 5px;" asp-route-id="@user.UserId" asp-controller="AdminPanel" asp-action="Edit">Edit</a>
                                <form asp-controller="AdminPanel" asp-action="SetAsPublicUser" method="post" style="display: inline-block;">
                                    <input type="hidden" name="id" value="@user.UserId" />
                                    <button type="submit" class="btn btn-primary rounded-pill" style="margin-right: 5px;">Public</button>
                                </form>
                                <form asp-controller="AdminPanel" asp-action="SetAsPrivileged" method="post" style="display: inline-block;">
                                    <input type="hidden" name="id" value="@user.UserId" />
                                    <button type="submit" class="btn btn-primary rounded-pill" style="margin-right: 5px;" @if (user.Role == "Privileged")
                                    {
                                        <text>disabled</text>
                                    }>Privileged</button>
                                </form>
                                <form asp-controller="AdminPanel" asp-action="SetAsAdministrator" method="post" style="display: inline-block;">
                                    <input type="hidden" name="id" value="@user.UserId" />
                                    <button type="submit" class="btn btn-primary rounded-pill" @if (user.Role == "Administrator")
                                    {
                                        <text>disabled</text>
                                    }>Administrator</button>
                                </form>
                            </div>
                        }
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>
<a href="@Url.Action("ExportUsersToCSV", "AdminPanel")" class="btn btn-primary">Export Data</a>
